<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Test Report - database - 2025-03-25 22:56:15</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        :root {
            --primary-color: #2563eb;
            --primary-light: #dbeafe;
            --success-color: #16a34a;
            --success-light: #dcfce7;
            --error-color: #dc2626;
            --error-light: #fee2e2;
            --warning-color: #d97706;
            --warning-light: #fef3c7;
            --info-color: #0891b2;
            --info-light: #e0f2fe;
            --text-color: #1f2937;
            --text-light: #6b7280;
            --bg-color: #ffffff;
            --bg-light: #f9fafb;
            --border-color: #e5e7eb;
            --header-bg: #1e293b;  /* Dark background for header instead of blue */
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 0;
            color: var(--text-color);
            background-color: var(--bg-light);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background-color: var(--header-bg);
            color: white;
            padding: 1rem;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .header-container {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo {
            height: 40px;
            width: auto;
        }

        header h1 {
            margin: 0;
            font-size: 1.8rem;
            flex: 1;
        }

        .card {
            background-color: var(--bg-color);
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            margin-bottom: 1rem;
            overflow: hidden;
        }

        .card-header {
            padding: 1rem;
            background-color: var(--bg-light);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-header h2, .card-header h3 {
            margin: 0;
            font-size: 1.2rem;
        }

        .card-body {
            padding: 1rem;
        }

        .summary {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .summary-item {
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
        }

        .summary-passed {
            background-color: var(--success-light);
            color: var (--success-color);
        }

        .summary-failed {
            background-color: var(--error-light);
            color: var(--error-color);
        }

        .summary-skipped {
            background-color: var(--warning-light);
            color: var(--warning-color);
        }

        .summary-all {
            background-color: var(--info-light);
            color: var(--info-color);
        }

        .summary-number {
            font-size: 2rem;
            font-weight: bold;
            display: block;
            margin-bottom: 0.5rem;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1rem;
        }

        th, td {
            padding: 0.75rem;
            border-bottom: 1px solid var(--border-color);
            text-align: left;
        }

        th {
            background-color: var(--bg-light);
            font-weight: 600;
        }

        tr:hover {
            background-color: var(--bg-light);
        }

        .status-badge {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .passed {
            background-color: var(--success-light);
            color: var (--success-color);
        }

        .failed {
            background-color: var(--error-light);
            color: var(--error-color);
        }

        .skipped {
            background-color: var(--warning-light);
            color: var(--warning-color);
        }

        .unknown {
            background-color: var(--info-light);
            color: var(--info-color);
        }

        .text-passed {
            color: var(--success-color);
        }

        .text-failed {
            color: var(--error-color);
        }

        .text-skipped {
            color: var(--warning-color);
        }

        .collapsible {
            cursor: pointer;
        }

        .collapsible:after {
            content: "\f078";
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
            float: right;
            margin-left: 5px;
        }

        .active:after {
            content: "\f077";
        }

        .content {
            display: none;
            overflow: hidden;
            padding: 0;
            background-color: white;
        }

        .test-details {
            border-left: 4px solid var(--border-color);
            margin: 1rem 0;
            background-color: white;
            border-radius: 6px;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }

        .test-passed {
            border-left-color: var(--success-color);
        }

        .test-failed {
            border-left-color: var(--error-color);
        }

        .test-skipped {
            border-left-color: var(--warning-color);
        }

        .test-output {
            background-color: var(--bg-light);
            padding: 1rem;
            border-radius: 0 0 4px 4px;
            overflow-x: auto;
            white-space: pre-wrap;
            font-family: monospace;
            font-size: 0.9rem;
            margin: 0;
            border-top: 1px solid var(--border-color);
        }

        .filter-controls {
            margin-bottom: 1rem;
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .filter-btn {
            border: none;
            background-color: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 0.5rem 1rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
        }

        .filter-btn:hover {
            background-color: var(--bg-light);
        }

        .filter-btn.active {
            background-color: var(--primary-light);
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        .icon {
            display: inline-block;
            width: 20px;
            text-align: center;
        }

        pre {
            white-space: pre-wrap;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 0.9rem;
            margin: 0;
            padding: 1rem;
            background-color: var(--bg-light);
            border-radius: 4px;
            overflow-x: auto;
        }

        button.collapsible {
            background-color: var(--bg-light);
            padding: 0.75rem 1rem;
            width: 100%;
            border: 1px solid var(--border-color);
            text-align: left;
            outline: none;
            border-radius: 4px;
            margin-bottom: 0.5rem;
            transition: background-color 0.2s;
            font-weight: 500;
        }

        button.collapsible:hover {
            background-color: #e5e7eb;
        }

        @media (max-width: 768px) {
            .summary {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-container">
                <svg class="logo" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 2L2 7L12 12L22 7L12 2Z" fill="#38bdf8" />
                    <path d="M2 17L12 22L22 17" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    <path d="M2 12L12 17L22 12" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
                <h1>Test Report - database</h1>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="card">
            <div class="card-header">
                <h2>Test Summary</h2>
                <span>2025-03-25 22:56:15</span>
            </div>
            <div class="card-body">
                <div class="summary">
                    <div class="summary-item summary-all">
                        <span class="summary-number">3</span>
                        <span>Total Tests</span>
                    </div>
                    <div class="summary-item summary-passed">
                        <span class="summary-number">0</span>
                        <span>Passed</span>
                    </div>
                    <div class="summary-item summary-failed">
                        <span class="summary-number">3</span>
                        <span>Failed</span>
                    </div>
                    <div class="summary-item summary-skipped">
                        <span class="summary-number">0</span>
                        <span>Skipped</span>
                    </div>
                </div>

                <table>
                    <tr>
                        <th>Category</th>
                        <td>database</td>
                    </tr>
                    <tr>
                        <th>Marker</th>
                        <td>None</td>
                    </tr>
                    <tr>
                        <th>Keyword</th>
                        <td>None</td>
                    </tr>
                    <tr>
                        <th>Status</th>
                        <td><span class="status-badge failed">Failed</span></td>
                    </tr>
                    <tr>
                        <th>Return Code</th>
                        <td>1</td>
                    </tr>
                </table>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <h2>Test Results</h2>
            </div>
            <div class="card-body">
                <div class="filter-controls">
                    <button class="filter-btn active" data-filter="all">
                        <span class="icon"><i class="fas fa-list"></i></span>
                        All Tests
                    </button>
                    <button class="filter-btn" data-filter="passed">
                        <span class="icon"><i class="fas fa-check text-passed"></i></span>
                        Passed
                    </button>
                    <button class="filter-btn" data-filter="failed">
                        <span class="icon"><i class="fas fa-times text-failed"></i></span>
                        Failed
                    </button>
                    <button class="filter-btn" data-filter="skipped">
                        <span class="icon"><i class="fas fa-forward text-skipped"></i></span>
                        Skipped
                    </button>
                </div>

                <div id="test-results">
                    
                    <div class="test-details test-failed" data-status="failed">
                        <div class="card-header collapsible">
                            <span>
                                <span class="icon">
                                    <i class="fas fa-times text-failed"></i>
                                </span>
                                tests/database/test_db_connection.py :: test_db_connection FAILED          [ 33%]
                            </span>
                            <span class="status-badge failed">Failed</span>
                        </div>
                        <div class="content">
                            <div class="test-output"></div>
                        </div>
                    </div>
                    
                    <div class="test-details test-failed" data-status="failed">
                        <div class="card-header collapsible">
                            <span>
                                <span class="icon">
                                    <i class="fas fa-times text-failed"></i>
                                </span>
                                tests/database/test_db_connection.py :: test_user_table FAILED             [ 66%]
                            </span>
                            <span class="status-badge failed">Failed</span>
                        </div>
                        <div class="content">
                            <div class="test-output"></div>
                        </div>
                    </div>
                    
                    <div class="test-details test-failed" data-status="failed">
                        <div class="card-header collapsible">
                            <span>
                                <span class="icon">
                                    <i class="fas fa-times text-failed"></i>
                                </span>
                                tests/database/test_db_connection.py :: test_admin_user_exists FAILED      [100%]
                            </span>
                            <span class="status-badge failed">Failed</span>
                        </div>
                        <div class="content">
                            <div class="test-output">
================================== FAILURES ===================================
_____________________________ test_db_connection ______________________________
tests\database\test_db_connection.py:68: in test_db_connection
    async with engine.connect() as conn:
E   AttributeError: 'async_generator' object has no attribute 'connect'

During handling of the above exception, another exception occurred:
tests\database\test_db_connection.py:75: in test_db_connection
    pytest.fail(f"Database connection failed: {str(e)}")
E   Failed: Database connection failed: 'async_generator' object has no attribute 'connect'
------------------------------ Captured log call ------------------------------
ERROR    test_db_connection:test_db_connection.py:74 \u274c Database connection failed: 'async_generator' object has no attribute 'connect'
_______________________________ test_user_table _______________________________
tests\database\test_db_connection.py:88: in test_user_table
    result = await async_session.execute(text(query))
E   AttributeError: 'async_generator' object has no attribute 'execute'
------------------------------ Captured log call ------------------------------
ERROR    test_db_connection:test_db_connection.py:98 \u274c User table query failed: 'async_generator' object has no attribute 'execute'
___________________________ test_admin_user_exists ____________________________
tests\database\test_db_connection.py:111: in test_admin_user_exists
    result = await async_session.execute(text(query))
E   AttributeError: 'async_generator' object has no attribute 'execute'
------------------------------ Captured log call ------------------------------
ERROR    test_db_connection:test_db_connection.py:126 \u274c Admin user verification failed: 'async_generator' object has no attribute 'execute'

Test Run Summary
===============
Total: 3
Passed: 0
Failed: 3
Skipped: 0
Duration: 22:56:15
=========================== short test summary info ===========================
FAILED tests/database/test_db_connection.py::test_db_connection - Failed: Dat...
FAILED tests/database/test_db_connection.py::test_user_table - AttributeError...
FAILED tests/database/test_db_connection.py::test_admin_user_exists - Attribu...
============================== 3 failed in 0.41s ==============================</div>
                        </div>
                    </div>
                    
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <h2>Raw Test Output</h2>
            </div>
            <div class="card-body">
                <button class="collapsible">Show Raw Test Output</button>
                <div class="content">
                    <pre>============================= test session starts =============================
platform win32 -- Python 3.12.0, pytest-8.3.5, pluggy-1.5.0 -- C:\Users\jnguyen\Documents\Work\Projects\appointmentsystem\backend\venv\Scripts\python.exe
cachedir: .pytest_cache
metadata: {'Python': '3.12.0', 'Platform': 'Windows-11-10.0.26100-SP0', 'Packages': {'pytest': '8.3.5', 'pluggy': '1.5.0'}, 'Plugins': {'anyio': '4.9.0', 'asyncio': '0.21.2', 'cov': '4.1.0', 'html': '2.1.1', 'metadata': '3.1.1'}, 'JAVA_HOME': 'C:\\Program Files\\Java\\jdk-23'}
rootdir: C:\Users\jnguyen\Documents\Work\Projects\appointmentsystem\backend
configfile: pytest.ini
plugins: anyio-4.9.0, asyncio-0.21.2, cov-4.1.0, html-2.1.1, metadata-3.1.1
asyncio: mode=Mode.STRICT
collecting ... collected 3 items

tests/database/test_db_connection.py::test_db_connection FAILED          [ 33%]
tests/database/test_db_connection.py::test_user_table FAILED             [ 66%]
tests/database/test_db_connection.py::test_admin_user_exists FAILED      [100%]

================================== FAILURES ===================================
_____________________________ test_db_connection ______________________________
tests\database\test_db_connection.py:68: in test_db_connection
    async with engine.connect() as conn:
E   AttributeError: 'async_generator' object has no attribute 'connect'

During handling of the above exception, another exception occurred:
tests\database\test_db_connection.py:75: in test_db_connection
    pytest.fail(f"Database connection failed: {str(e)}")
E   Failed: Database connection failed: 'async_generator' object has no attribute 'connect'
------------------------------ Captured log call ------------------------------
ERROR    test_db_connection:test_db_connection.py:74 \u274c Database connection failed: 'async_generator' object has no attribute 'connect'
_______________________________ test_user_table _______________________________
tests\database\test_db_connection.py:88: in test_user_table
    result = await async_session.execute(text(query))
E   AttributeError: 'async_generator' object has no attribute 'execute'
------------------------------ Captured log call ------------------------------
ERROR    test_db_connection:test_db_connection.py:98 \u274c User table query failed: 'async_generator' object has no attribute 'execute'
___________________________ test_admin_user_exists ____________________________
tests\database\test_db_connection.py:111: in test_admin_user_exists
    result = await async_session.execute(text(query))
E   AttributeError: 'async_generator' object has no attribute 'execute'
------------------------------ Captured log call ------------------------------
ERROR    test_db_connection:test_db_connection.py:126 \u274c Admin user verification failed: 'async_generator' object has no attribute 'execute'

Test Run Summary
===============
Total: 3
Passed: 0
Failed: 3
Skipped: 0
Duration: 22:56:15
=========================== short test summary info ===========================
FAILED tests/database/test_db_connection.py::test_db_connection - Failed: Dat...
FAILED tests/database/test_db_connection.py::test_user_table - AttributeError...
FAILED tests/database/test_db_connection.py::test_admin_user_exists - Attribu...
============================== 3 failed in 0.41s ==============================
</pre>
                </div>

                <button class="collapsible">Show Error Output</button>
                <div class="content">
                    <pre>No errors reported.</pre>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize all collapsible elements
        document.addEventListener('DOMContentLoaded', function() {
            // Collapsible sections
            var coll = document.getElementsByClassName("collapsible");
            for (var i = 0; i < coll.length; i++) {
                coll[i].addEventListener("click", function() {
                    this.classList.toggle("active");
                    var content = this.nextElementSibling;
                    if (content.style.display === "block") {
                        content.style.display = "none";
                    } else {
                        content.style.display = "block";
                    }
                });
            }

            // Filter functionality
            var filterBtns = document.querySelectorAll('.filter-btn');
            filterBtns.forEach(function(btn) {
                btn.addEventListener('click', function() {
                    // Remove active class from all buttons
                    filterBtns.forEach(function(innerBtn) {
                        innerBtn.classList.remove('active');
                    });

                    // Add active class to clicked button
                    this.classList.add('active');

                    // Get filter value
                    var filter = this.getAttribute('data-filter');

                    // Filter test results
                    var testResults = document.querySelectorAll('#test-results .test-details');
                    testResults.forEach(function(test) {
                        if (filter === 'all' || test.getAttribute('data-status') === filter) {
                            test.style.display = 'block';
                        } else {
                            test.style.display = 'none';
                        }
                    });
                });
            });

            // Auto-open failed tests
            var failedTests = document.querySelectorAll('.test-failed .collapsible');
            failedTests.forEach(function(test) {
                test.click();
            });
        });
    </script>
</body>
</html>
